# 用户专属微光功能

## 功能概述

在灯塔地图上，当用户送出微光后，会在地图中心偏上位置出现一个**专属的微光点**，带有梦幻的多层呼吸动画，象征着"你的光，刚刚亮了一下"。

## 视觉设计

### 位置
```
灯塔地图
    ↓
  中心偏上（35%）
    ↓
用户专属光点
```

### 四层结构

#### 1. 外层光晕（最大范围）
- **尺寸**：80px
- **颜色**：`colors.lighthouse.light`（暖黄）
- **透明度**：0.1 ↔ 0.5（慢速脉动）
- **阴影**：`shadowRadius: 30, shadowOpacity: 0.6`
- **动画周期**：2500ms

#### 2. 中层光晕（过渡层）
- **尺寸**：50px
- **透明度**：0.3 ↔ 0.7（中速脉动）
- **阴影**：`shadowRadius: 20, shadowOpacity: 0.8`
- **动画周期**：1800ms
- **缩放**：scale × 1.2

#### 3. 内层核心（最亮）
- **尺寸**：24px
- **透明度**：0.6 ↔ 1（快速闪烁）
- **阴影**：`shadowRadius: 15, shadowOpacity: 1`
- **动画周期**：1200ms

#### 4. 中心点（固定）
- **尺寸**：8px
- **颜色**：纯白
- **透明度**：固定1.0
- **无动画**：作为视觉锚点

### 动画效果

#### 点亮瞬间（爆发动画）
```typescript
时间轴：
0ms:    scale: 0, opacity: 0
600ms:  scale: 1.8, opacity: 1 (爆发)
1000ms: scale: 1, opacity: 0.8 (回落)
```

**视觉效果**：
- 从无到有的爆发
- 光晕快速扩散
- 柔和回落到稳定状态

#### 持续呼吸（循环动画）
```typescript
内层：1200ms周期，快速闪烁
中层：1800ms周期，中速脉动
外层：2500ms周期，慢速扩散
缩放：2000ms周期，1.0 ↔ 1.15
```

**视觉效果**：
- 三层不同频率的呼吸
- 形成复杂的光晕变化
- 如同心跳般的节奏感

## 技术实现

### 组件：UserLightPoint
```typescript
<UserLightPoint 
  justLit={true}  // 是否刚刚点亮
/>
```

### 状态管理：lighthouseStore
```typescript
interface LighthouseStore {
  userHasLit: boolean;  // 用户是否点亮过
  justLit: boolean;     // 是否刚刚点亮
  lightUp: () => void;  // 点亮动作
  resetJustLit: () => void; // 重置状态
}
```

### 触发流程
```
用户点击"送微光" 
    ↓
填写留言（可选）
    ↓
点击"送出 ✨"
    ↓
lightUp() 触发
    ↓
地图上显示用户光点
    ↓
爆发动画（3秒）
    ↓
持续呼吸动画
```

## 交互细节

### 1. 首次点亮
- 光点从无到有
- 爆发动画吸引注意
- Toast提示："你的光，刚刚亮了一下"

### 2. 再次访问
- 光点已存在
- 持续呼吸动画
- 无爆发效果

### 3. 每日重置
- 每天可以重新点亮
- 重新触发爆发动画
- 保持新鲜感

## 视觉对比

### 其他用户光点
```
- 尺寸：8px
- 颜色：暖黄
- 动画：简单闪烁
- 频率：随机
```

### 用户专属光点
```
- 尺寸：80px（含光晕）
- 颜色：暖黄 + 白色中心
- 动画：多层呼吸 + 爆发
- 频率：三层不同周期
- 位置：中心偏上
```

## 心理学考量

### 归属感
- "这是我的光"
- 在众多光点中找到自己
- 视觉上的身份认同

### 成就感
- 点亮瞬间的爆发效果
- 持续存在的光点
- "我在这里留下了痕迹"

### 陪伴感
- 光点持续呼吸
- 如同生命体
- "我的光还在"

### 温暖感
- 暖黄色调
- 柔和的光晕
- 梦幻的扩散效果

## 代码结构

### 新增文件
```
src/components/lighthouse/UserLightPoint.tsx
  - 用户专属光点组件
  - 多层动画实现
  - 爆发效果处理
```

### 修改文件
```
src/store/lighthouseStore.ts
  - 添加 userHasLit 状态
  - 添加 justLit 状态
  - 添加 lightUp() 方法

app/lighthouse.tsx
  - 导入 UserLightPoint
  - 导入 useLighthouseStore
  - 在送微光时触发 lightUp()
  - 条件渲染用户光点
```

## 动画参数调优

### 爆发动画
```typescript
duration: 600ms  // 爆发速度
easing: Easing.out(Easing.ease)  // 快出慢入
maxScale: 1.8  // 最大缩放
```

### 呼吸动画
```typescript
innerCycle: 1200ms  // 内层周期
middleCycle: 1800ms  // 中层周期
outerCycle: 2500ms  // 外层周期
scaleRange: 1.0 - 1.15  // 缩放范围
```

### 透明度范围
```typescript
inner: 0.6 - 1.0  // 最亮
middle: 0.3 - 0.7  // 中等
outer: 0.1 - 0.5  // 最淡
```

## 性能优化

### 动画优化
- 使用 `useSharedValue` 和 `useAnimatedStyle`
- GPU 加速
- 避免 JS 线程阻塞

### 条件渲染
- 只在 `userHasLit === true` 时渲染
- 避免不必要的组件挂载

### 状态管理
- 3秒后重置 `justLit` 状态
- 避免重复触发爆发动画

## 未来增强（可选）

### 可能的功能
- [ ] 光点颜色随心情变化
- [ ] 长按光点查看历史
- [ ] 光点之间连线（社交）
- [ ] 光点轨迹记录

### 保持克制
- ✓ 不添加社交功能
- ✓ 保持匿名性
- ✓ 避免攀比心理
- ✓ 专注情感体验

## 用户体验流程

### 完整流程
```
1. 进入灯塔页面
   └─ 看到灯塔旋转、其他光点闪烁

2. 向下滚动到微光墙
   └─ 看到其他人的祝福

3. 点击"送一束微光"
   └─ 弹窗出现

4. 填写留言（可选）
   └─ 或留空使用随机祝福

5. 点击"送出 ✨"
   └─ 弹窗关闭
   └─ Toast："你的光，刚刚亮了一下"

6. 向上滚动回到地图
   └─ 看到自己的光点爆发
   └─ 光晕快速扩散
   └─ 回落到持续呼吸

7. 感受到温暖和归属
   └─ "我在这里留下了痕迹"
   └─ "我的光还在闪烁"
```

## 设计哲学

> **"你的光，值得被看见"**

### 核心价值
1. **可见性** - 让用户的付出被看见
2. **持久性** - 光点持续存在，不是一闪而过
3. **独特性** - 用户的光点与众不同
4. **温暖感** - 视觉上的情感共鸣

### 情感目标
- 不孤单："我的光和其他人的光在一起"
- 有意义："我做的事留下了痕迹"
- 被接纳："我的光也是美的"
- 有归属："这里有我的位置"

---

**设计理念**：  
每一束微光都值得被温柔对待。
